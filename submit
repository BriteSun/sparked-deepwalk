#!/bin/bash

if [ $# -eq 0 ] 
then
  echo "Usage: submit dataset_name"
  exit 1
fi

SAVE_PATH="output/"
NO_OF_RANDOM_WALKS=3
RANDOM_WALK_LENGTH=10


DATASET=$1
echo $DATASET

if [ $DATASET = 'blog' ]
then
  DATASET_NAME="BlogCatalog"
  DATASET_ROOT="datasets/BlogCatalog/data/"
  EDGES_FILE="edges.csv"
  NODES_FILE="nodes.csv"
  LABELS_FILE="groups.csv"
  NODE_TAG_FILE="group-edges.csv" 
elif [ $DATASET = 'youtube' ]
then
  DATASET_NAME="Youtube"
  DATASET_ROOT="datasets/YouTube/data/"
  EDGES_FILE="edges.csv"
  NODES_FILE="nodes.csv"
  LABELS_FILE="groups.csv"
  NODE_TAG_FILE="group-edges.csv" 
fi


# build the dgtree
time spark-submit --master local[8] \
                  --class com.nrl.SparkedDeepWalkApp \
                  target/scala-2.11/sparked-deepwalk_2.11-1.0.jar \
                  $DATASET_NAME \
                  $DATASET_ROOT \
                  $NODES_FILE \
                  $EDGES_FILE \
                  $LABELS_FILE \
                  $NODE_TAG_FILE \
                  $SAVE_PATH \
                  $RANDOM_WALK_LENGTH \
                  $NO_OF_RANDOM_WALKS

OUTPUT_SUFFIX="_vertex_visit_freq.csv"

python utils/degree_plot.py $SAVE_PATH$DATASET_NAME$OUTPUT_SUFFIX $DATASET_NAME 
